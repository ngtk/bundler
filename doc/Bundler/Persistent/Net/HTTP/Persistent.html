<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Bundler::Persistent::Net::HTTP::Persistent
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Bundler::Persistent::Net::HTTP::Persistent";
  relpath = '../../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../../class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../../Bundler.html" title="Bundler (module)">Bundler</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../Persistent.html" title="Bundler::Persistent (module)">Persistent</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Net.html" title="Bundler::Persistent::Net (module)">Net</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../HTTP.html" title="Bundler::Persistent::Net::HTTP (module)">HTTP</a></span></span>
     &raquo; 
    <span class="title">Persistent</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="../../../../class_list.html"></iframe>

      <div id="content"><h1>Class: Bundler::Persistent::Net::HTTP::Persistent
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Bundler::Persistent::Net::HTTP::Persistent</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Persistent connections for Net::HTTP</p>

<p>Bundler::Persistent::Net::HTTP::Persistent maintains persistent connections
across all the servers you wish to talk to.  For each host:port you
communicate with a single persistent connection is created.</p>

<p>Multiple Bundler::Persistent::Net::HTTP::Persistent objects will share the
same set of connections.</p>

<p>For each thread you start a new connection will be created.  A
Bundler::Persistent::Net::HTTP::Persistent connection will not be shared
across threads.</p>

<p>You can shut down the HTTP connections when done by calling #shutdown.  You
should name your Bundler::Persistent::Net::HTTP::Persistent object if you
intend to call this method.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bundler/vendor/net-http-persistent/lib/net/http/persistent</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://example.com/awesome/web/service</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_http'>http</span> <span class='op'>=</span> <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Persistent</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_app_name</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># perform a GET
</span><span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_uri'>uri</span>

<span class='comment'># or
</span>
<span class='id identifier rubyid_get'>get</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Get</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span>
<span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_get'>get</span>

<span class='comment'># create a POST
</span><span class='id identifier rubyid_post_uri'>post_uri</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_post'>post</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_post_uri'>post_uri</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
<span class='id identifier rubyid_post'>post</span><span class='period'>.</span><span class='id identifier rubyid_set_form_data'>set_form_data</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>some</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cool data</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># perform the POST, the URI is always required
</span><span class='id identifier rubyid_response'>response</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_post_uri'>post_uri</span><span class='comma'>,</span> <span class='id identifier rubyid_post'>post</span>
</code></pre>

<p>Note that for GET, HEAD and other requests that do not have a body you want
to use URI#request_uri not URI#path.  The request_uri contains the query
params which are sent in the body for other requests.</p>

<h2 id="label-SSL">SSL</h2>

<p>SSL connections are automatically created depending upon the scheme of the
URI.  SSL connections are automatically verified against the default
certificate store for your computer.  You can override this by changing
verify_mode or by specifying an alternate cert_store.</p>

<p>Here are the SSL settings, see the individual methods for documentation:</p>
<dl class="rdoc-list note-list"><dt>#certificate        
<dd>
<p>This client&#39;s certificate</p>
</dd><dt>#ca_file            
<dd>
<p>The certificate-authority</p>
</dd><dt>#cert_store         
<dd>
<p>An SSL certificate store</p>
</dd><dt>#private_key        
<dd>
<p>The client&#39;s SSL private key</p>
</dd><dt>#reuse_ssl_sessions 
<dd>
<p>Reuse a previously opened SSL session for a new connection</p>
</dd><dt>#ssl_version        
<dd>
<p>Which specific SSL version to use</p>
</dd><dt>#verify_callback    
<dd>
<p>For server certificate verification</p>
</dd><dt>#verify_mode        
<dd>
<p>How connections should be verified</p>
</dd></dl>

<h2 id="label-Proxies">Proxies</h2>

<p>A proxy can be set through #proxy= or at initialization time by providing a
second argument to ::new.  The proxy may be the URI of the proxy server or
<code>:ENV</code> which will consult environment variables.</p>

<p>See #proxy= and #proxy_from_env for details.</p>

<h2 id="label-Headers">Headers</h2>

<p>Headers may be specified for use in every request.  #headers are appended
to any headers on the request.  #override_headers replace existing headers
on the request.</p>

<p>The difference between the two can be seen in setting the User-Agent. 
Using <code>http.headers['User-Agent'] = &#39;MyUserAgent&#39;</code> will
send “Ruby, MyUserAgent” while <code>http.override_headers['User-Agent'] =
&#39;MyUserAgent&#39;</code> will send “MyUserAgent”.</p>

<h2 id="label-Tuning">Tuning</h2>

<h3 id="label-Segregation">Segregation</h3>

<p>By providing an application name to ::new you can separate your connections
from the connections of other applications.</p>

<h3 id="label-Idle+Timeout">Idle Timeout</h3>

<p>If a connection hasn&#39;t been used for this number of seconds it will
automatically be reset upon the next use to avoid attempting to send to a
closed connection. The default value is 5 seconds. nil means no timeout.
Set through #idle_timeout.</p>

<p>Reducing this value may help avoid the “too many connection resets” error
when sending non-idempotent requests while increasing this value will cause
fewer round-trips.</p>

<h3 id="label-Read+Timeout">Read Timeout</h3>

<p>The amount of time allowed between reading two chunks from the socket.  Set
through #read_timeout</p>

<h3 id="label-Max+Requests">Max Requests</h3>

<p>The number of requests that should be made before opening a new connection.
Typically many keep-alive capable servers tune this to 100 or less, so the
101st request will fail with ECONNRESET. If unset (default), this value has
no effect, if set, connections will be reset on the request after
max_requests.</p>

<h3 id="label-Open+Timeout">Open Timeout</h3>

<p>The amount of time to wait for a connection to be opened.  Set through
#open_timeout.</p>

<h3 id="label-Socket+Options">Socket Options</h3>

<p>Socket options may be set on newly-created connections.  See
#socket_options for details.</p>

<h3 id="label-Non-Idempotent+Requests">Non-Idempotent Requests</h3>

<p>By default non-idempotent requests will not be retried per RFC 2616.  By
setting retry_change_requests to true requests will automatically be
retried once.</p>

<p>Only do this when you know that retrying a POST or other non-idempotent
request is safe for your application and will not create duplicate
resources.</p>

<p>The recommended way to handle non-idempotent requests is the following:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bundler/vendor/net-http-persistent/lib/net/http/persistent</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://example.com/awesome/web/service</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_post_uri'>post_uri</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_http'>http</span> <span class='op'>=</span> <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Persistent</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_app_name</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_post'>post</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Post</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_post_uri'>post_uri</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
<span class='comment'># ... fill in POST request
</span>
<span class='kw'>begin</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_post_uri'>post_uri</span><span class='comma'>,</span> <span class='id identifier rubyid_post'>post</span>
<span class='kw'>rescue</span> <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Error</span>

  <span class='comment'># POST failed, make a new request to verify the server did not process
</span>  <span class='comment'># the request
</span>  <span class='id identifier rubyid_exists_uri'>exists_uri</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>...</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span> <span class='id identifier rubyid_exists_uri'>exists_uri</span>

  <span class='comment'># Retry if it failed
</span>  <span class='kw'>retry</span> <span class='kw'>if</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>404</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>The method of determining if the resource was created or not is unique to
the particular service you are using.  Of course, you will want to add
protection from infinite looping.</p>

<h3 id="label-Connection+Termination">Connection Termination</h3>

<p>If you are done using the Bundler::Persistent::Net::HTTP::Persistent
instance you may shut down all the connections in the current thread with
#shutdown.  This is not recommended for normal use, it should only be used
when it will be several minutes before you make another HTTP request.</p>

<p>If you are using multiple threads, call #shutdown in each thread when the
thread is done making requests.  If you don&#39;t call shutdown, that&#39;s
OK. Ruby will automatically garbage collect and shutdown your HTTP
connections when the thread terminates.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Persistent/Error.html" title="Bundler::Persistent::Net::HTTP::Persistent::Error (class)">Error</a></span>, <span class='object_link'><a href="Persistent/SSLReuse.html" title="Bundler::Persistent::Net::HTTP::Persistent::SSLReuse (class)">SSLReuse</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="EPOCH-constant" class="">EPOCH =
        <div class="docstring">
  <div class="discussion">
    
<p>The beginning of Time</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_at'>at</span> <span class='int'>0</span></pre></dd>
    
      <dt id="HAVE_OPENSSL-constant" class="">HAVE_OPENSSL =
        <div class="docstring">
  <div class="discussion">
    
<p>Is OpenSSL available?  This test works with autoload</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='kw'>defined?</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span> <span class='comment'># :nodoc:</span></pre></dd>
    
      <dt id="VERSION-constant" class="">VERSION =
        <div class="docstring">
  <div class="discussion">
    
<p>The version of Bundler::Persistent::Net::HTTP::Persistent you are using</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2.9.4</span><span class='tstring_end'>&#39;</span></span></pre></dd>
    
      <dt id="RETRIED_EXCEPTIONS-constant" class="">RETRIED_EXCEPTIONS =
        <div class="docstring">
  <div class="discussion">
    
<p>Exceptions rescued for automatic retry on ruby 2.0.0.  This overlaps with
the exception list for ruby 1.x.</p>


  </div>
</div>
<div class="tags">
  

</div>
      </dt>
      <dd><pre class="code"><span class='lbracket'>[</span> <span class='comment'># :nodoc:
</span>  <span class='lparen'>(</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>ReadTimeout</span> <span class='kw'>if</span> <span class='const'>Net</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span> <span class='symbol'>:ReadTimeout</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='const'>IOError</span><span class='comma'>,</span>
  <span class='const'>EOFError</span><span class='comma'>,</span>
  <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNRESET</span><span class='comma'>,</span>
  <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNABORTED</span><span class='comma'>,</span>
  <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EPIPE</span><span class='comma'>,</span>
  <span class='lparen'>(</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>SSLError</span> <span class='kw'>if</span> <span class='const'>HAVE_OPENSSL</span><span class='rparen'>)</span><span class='comma'>,</span>
  <span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span>
<span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span></pre></dd>
    
  </dl>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ca_file-instance_method" title="#ca_file (instance method)">#<strong>ca_file</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An SSL certificate authority.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#cert_store-instance_method" title="#cert_store (instance method)">#<strong>cert_store</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An SSL certificate store.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#certificate-instance_method" title="#certificate (instance method)">#<strong>certificate</strong>  &#x21d2; Object </a>
    

    
      (also: #cert)
    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This client&#39;s OpenSSL::X509::Certificate.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#debug_output-instance_method" title="#debug_output (instance method)">#<strong>debug_output</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sends debug_output to this IO via Net::HTTP#set_debug_output.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#generation-instance_method" title="#generation (instance method)">#<strong>generation</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current connection generation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#generation_key-instance_method" title="#generation_key (instance method)">#<strong>generation_key</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Where this instance&#39;s connections live in the thread local variables.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#headers-instance_method" title="#headers (instance method)">#<strong>headers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Headers that are added to every request using Net::HTTP#add_field.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#http_versions-instance_method" title="#http_versions (instance method)">#<strong>http_versions</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Maps host:port to an HTTP version.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#idle_timeout-instance_method" title="#idle_timeout (instance method)">#<strong>idle_timeout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Maximum time an unused connection can remain idle before being
automatically closed.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#keep_alive-instance_method" title="#keep_alive (instance method)">#<strong>keep_alive</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The value sent in the Keep-Alive header.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_requests-instance_method" title="#max_requests (instance method)">#<strong>max_requests</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Maximum number of requests on a connection before it is considered expired
and automatically closed.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A name for this connection.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#no_proxy-instance_method" title="#no_proxy (instance method)">#<strong>no_proxy</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>List of host suffixes which will not be proxied.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#open_timeout-instance_method" title="#open_timeout (instance method)">#<strong>open_timeout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Seconds to wait until a connection is opened.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#override_headers-instance_method" title="#override_headers (instance method)">#<strong>override_headers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Headers that are added to every request using Net::HTTP#[]=.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#private_key-instance_method" title="#private_key (instance method)">#<strong>private_key</strong>  &#x21d2; Object </a>
    

    
      (also: #key)
    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This client&#39;s SSL private key.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy_uri-instance_method" title="#proxy_uri (instance method)">#<strong>proxy_uri</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The URL through which requests will be proxied.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_timeout-instance_method" title="#read_timeout (instance method)">#<strong>read_timeout</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Seconds to wait until reading one block.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#request_key-instance_method" title="#request_key (instance method)">#<strong>request_key</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Where this instance&#39;s request counts live in the thread local
variables.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#retry_change_requests-instance_method" title="#retry_change_requests (instance method)">#<strong>retry_change_requests</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Enable retries of non-idempotent requests that change data (e.g. POST
requests) when the server has disconnected.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reuse_ssl_sessions-instance_method" title="#reuse_ssl_sessions (instance method)">#<strong>reuse_ssl_sessions</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>By default SSL sessions are reused to avoid extra SSL handshakes.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#socket_options-instance_method" title="#socket_options (instance method)">#<strong>socket_options</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>An array of options for Socket#setsockopt.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl_generation-instance_method" title="#ssl_generation (instance method)">#<strong>ssl_generation</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current SSL connection generation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl_generation_key-instance_method" title="#ssl_generation_key (instance method)">#<strong>ssl_generation_key</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Where this instance&#39;s SSL connections live in the thread local
variables.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl_version-instance_method" title="#ssl_version (instance method)">#<strong>ssl_version</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>SSL version to use.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_key-instance_method" title="#timeout_key (instance method)">#<strong>timeout_key</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Where this instance&#39;s last-use times live in the thread local
variables.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#verify_callback-instance_method" title="#verify_callback (instance method)">#<strong>verify_callback</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>SSL verification callback.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#verify_mode-instance_method" title="#verify_mode (instance method)">#<strong>verify_mode</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>HTTPS verify mode.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#detect_idle_timeout-class_method" title="detect_idle_timeout (class method)">.<strong>detect_idle_timeout</strong>(uri, max = 10)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Use this method to detect the idle timeout of the host at <code>uri</code>.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#can_retry%3F-instance_method" title="#can_retry? (instance method)">#<strong>can_retry?</strong>(req, retried_on_ruby_2 = false)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Is the request <code>req</code> idempotent or is retry_change_requests
allowed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup-instance_method" title="#cleanup (instance method)">#<strong>cleanup</strong>(generation, thread = Thread.current, generation_key = @generation_key)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finishes all connections on the given <code>thread</code> that were created
before the given <code>generation</code> in the threads
<code>generation_key</code> list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection_close%3F-instance_method" title="#connection_close? (instance method)">#<strong>connection_close?</strong>(header)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Workaround for missing Net::HTTPRequest#connection_close? on Ruby 1.8.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection_for-instance_method" title="#connection_for (instance method)">#<strong>connection_for</strong>(uri)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new connection for <code>uri</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection_keep_alive%3F-instance_method" title="#connection_keep_alive? (instance method)">#<strong>connection_keep_alive?</strong>(header)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Workaround for missing Net::HTTPRequest#connection_keep_alive? on Ruby 1.8.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#error_message-instance_method" title="#error_message (instance method)">#<strong>error_message</strong>(connection)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an error message containing the number of requests performed on
this connection.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#escape-instance_method" title="#escape (instance method)">#<strong>escape</strong>(str)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>URI::escape wrapper.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expired%3F-instance_method" title="#expired? (instance method)">#<strong>expired?</strong>(connection)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true if the connection should be reset due to an idle timeout, or
maximum request count, false otherwise.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finish-instance_method" title="#finish (instance method)">#<strong>finish</strong>(connection, thread = Thread.current)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finishes the Net::HTTP <code>connection</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http_class-instance_method" title="#http_class (instance method)">#<strong>http_class</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>:nodoc:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http_version-instance_method" title="#http_version (instance method)">#<strong>http_version</strong>(uri)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the HTTP protocol version for <code>uri</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#idempotent%3F-instance_method" title="#idempotent? (instance method)">#<strong>idempotent?</strong>(req)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Is <code>req</code> idempotent according to RFC 2616?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(name = nil, proxy = nil)  &#x21d2; Persistent </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a new Bundler::Persistent::Net::HTTP::Persistent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_age-instance_method" title="#max_age (instance method)">#<strong>max_age</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deprecated in favor of #expired?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#normalize_uri-instance_method" title="#normalize_uri (instance method)">#<strong>normalize_uri</strong>(uri)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds “http://” to the String <code>uri</code> if it is missing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pipeline-instance_method" title="#pipeline (instance method)">#<strong>pipeline</strong>(uri, requests, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pipelines <code>requests</code> to the HTTP server at <code>uri</code>
yielding responses if a block is given.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy%3D-instance_method" title="#proxy= (instance method)">#<strong>proxy=</strong>(proxy)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the proxy server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy_bypass%3F-instance_method" title="#proxy_bypass? (instance method)">#<strong>proxy_bypass?</strong>(host, port)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns true when proxy should by bypassed for host.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#proxy_from_env-instance_method" title="#proxy_from_env (instance method)">#<strong>proxy_from_env</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a URI for an HTTP proxy server from ENV variables.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reconnect-instance_method" title="#reconnect (instance method)">#<strong>reconnect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Forces reconnection of HTTP connections.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reconnect_ssl-instance_method" title="#reconnect_ssl (instance method)">#<strong>reconnect_ssl</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Forces reconnection of SSL connections.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#request-instance_method" title="#request (instance method)">#<strong>request</strong>(uri, req = nil, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Makes a request on <code>uri</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#request_failed-instance_method" title="#request_failed (instance method)">#<strong>request_failed</strong>(exception, req, connection)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Raises an Error for <code>exception</code> which resulted from attempting
the request <code>req</code> on the <code>connection</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#request_setup-instance_method" title="#request_setup (instance method)">#<strong>request_setup</strong>(req_or_uri)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a GET request if <code>req_or_uri</code> is a URI and adds headers
to the request.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-instance_method" title="#reset (instance method)">#<strong>reset</strong>(connection)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finishes then restarts the Net::HTTP <code>connection</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown-instance_method" title="#shutdown (instance method)">#<strong>shutdown</strong>(thread = Thread.current)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Shuts down all connections for <code>thread</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown_in_all_threads-instance_method" title="#shutdown_in_all_threads (instance method)">#<strong>shutdown_in_all_threads</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Shuts down all connections in all threads.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl-instance_method" title="#ssl (instance method)">#<strong>ssl</strong>(connection)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Enables SSL on <code>connection</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl_cleanup-instance_method" title="#ssl_cleanup (instance method)">#<strong>ssl_cleanup</strong>(generation)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finishes all connections that existed before the given SSL parameter
<code>generation</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>(connection)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Starts the Net::HTTP <code>connection</code>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unescape-instance_method" title="#unescape (instance method)">#<strong>unescape</strong>(str)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>URI::unescape wrapper.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(name = nil, proxy = nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Bundler::Persistent::Net::HTTP::Persistent (class)">Persistent</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a new Bundler::Persistent::Net::HTTP::Persistent.</p>

<p>Set <code>name</code> to keep your connections apart from everybody
else&#39;s.  Not required currently, but highly recommended.  Your library
name should be good enough.  This parameter will be required in a future
version.</p>

<p><code>proxy</code> may be set to a URI::HTTP or :ENV to pick up proxy
options from the environment.  See proxy_from_env for details.</p>

<p>In order to use a URI for the proxy you may need to do some extra work
beyond URI parsing if the proxy requires a password:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://proxy.example</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_proxy'>proxy</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AzureDiamond</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_proxy'>proxy</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hunter2</span><span class='tstring_end'>&#39;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 482</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>

  <span class='ivar'>@debug_output</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@proxy_uri</span>        <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@no_proxy</span>         <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@headers</span>          <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@override_headers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@http_versions</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@keep_alive</span>       <span class='op'>=</span> <span class='int'>30</span>
  <span class='ivar'>@open_timeout</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@read_timeout</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@idle_timeout</span>     <span class='op'>=</span> <span class='int'>5</span>
  <span class='ivar'>@max_requests</span>     <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@socket_options</span>   <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='ivar'>@socket_options</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>IPPROTO_TCP</span><span class='comma'>,</span> <span class='const'>Socket</span><span class='op'>::</span><span class='const'>TCP_NODELAY</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span> <span class='kw'>if</span>
    <span class='const'>Socket</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span> <span class='symbol'>:TCP_NODELAY</span>

  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net_http_persistent</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
  <span class='ivar'>@generation_key</span>     <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>generations</span><span class='tstring_end'>&#39;</span></span>    <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_intern'>intern</span>
  <span class='ivar'>@ssl_generation_key</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ssl_generations</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_intern'>intern</span>
  <span class='ivar'>@request_key</span>        <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>requests</span><span class='tstring_end'>&#39;</span></span>       <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_intern'>intern</span>
  <span class='ivar'>@timeout_key</span>        <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span>       <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_intern'>intern</span>

  <span class='ivar'>@certificate</span>        <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@ca_file</span>            <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@private_key</span>        <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@ssl_version</span>        <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@verify_callback</span>    <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@verify_mode</span>        <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@cert_store</span>         <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='ivar'>@generation</span>         <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># incremented when proxy URI changes
</span>  <span class='ivar'>@ssl_generation</span>     <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># incremented when SSL session variables change
</span>
  <span class='kw'>if</span> <span class='const'>HAVE_OPENSSL</span> <span class='kw'>then</span>
    <span class='ivar'>@verify_mode</span>        <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_PEER</span>
    <span class='ivar'>@reuse_ssl_sessions</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span> <span class='symbol'>:Session</span>
  <span class='kw'>end</span>

  <span class='ivar'>@retry_change_requests</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='ivar'>@ruby_1</span> <span class='op'>=</span> <span class='const'>RUBY_VERSION</span> <span class='op'>&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@retried_on_ruby_2</span> <span class='op'>=</span> <span class='op'>!</span><span class='ivar'>@ruby_1</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='id identifier rubyid_proxy'>proxy</span> <span class='kw'>if</span> <span class='id identifier rubyid_proxy'>proxy</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="ca_file=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="ca_file-instance_method">
  
    #<strong>ca_file</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An SSL certificate authority.  Setting this will set verify_mode to
VERIFY_PEER.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


291
292
293</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 291</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ca_file'>ca_file</span>
  <span class='ivar'>@ca_file</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="cert_store=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="cert_store-instance_method">
  
    #<strong>cert_store</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An SSL certificate store.  Setting this will override the default
certificate store.  See verify_mode for more information.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


297
298
299</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 297</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cert_store'>cert_store</span>
  <span class='ivar'>@cert_store</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="certificate=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="certificate-instance_method">
  
    #<strong>certificate</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='cert-instance_method'>cert</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This client&#39;s OpenSSL::X509::Certificate</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


282
283
284</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 282</span>

<span class='kw'>def</span> <span class='id identifier rubyid_certificate'>certificate</span>
  <span class='ivar'>@certificate</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="debug_output=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="debug_output-instance_method">
  
    #<strong>debug_output</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sends debug_output to this IO via Net::HTTP#set_debug_output.</p>

<p>Never use this method in production code, it causes a serious security
hole.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 305</span>

<span class='kw'>def</span> <span class='id identifier rubyid_debug_output'>debug_output</span>
  <span class='ivar'>@debug_output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="generation-instance_method">
  
    #<strong>generation</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Current connection generation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 310</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generation'>generation</span>
  <span class='ivar'>@generation</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="generation_key-instance_method">
  
    #<strong>generation_key</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Where this instance&#39;s connections live in the thread local variables</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


315
316
317</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 315</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generation_key'>generation_key</span>
  <span class='ivar'>@generation_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="headers-instance_method">
  
    #<strong>headers</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Headers that are added to every request using Net::HTTP#add_field</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


320
321
322</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 320</span>

<span class='kw'>def</span> <span class='id identifier rubyid_headers'>headers</span>
  <span class='ivar'>@headers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="http_versions-instance_method">
  
    #<strong>http_versions</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Maps host:port to an HTTP version.  This allows us to enable version
specific features.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


326
327
328</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 326</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http_versions'>http_versions</span>
  <span class='ivar'>@http_versions</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="idle_timeout=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="idle_timeout-instance_method">
  
    #<strong>idle_timeout</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Maximum time an unused connection can remain idle before being
automatically closed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_idle_timeout'>idle_timeout</span>
  <span class='ivar'>@idle_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="keep_alive=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="keep_alive-instance_method">
  
    #<strong>keep_alive</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The value sent in the Keep-Alive header.  Defaults to 30.  Not needed for
HTTP/1.1 servers.</p>

<p>This may not work correctly for HTTP/1.0 servers</p>

<p>This method may be removed in a future version as RFC 2616 does not require
this header.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 349</span>

<span class='kw'>def</span> <span class='id identifier rubyid_keep_alive'>keep_alive</span>
  <span class='ivar'>@keep_alive</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="max_requests=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="max_requests-instance_method">
  
    #<strong>max_requests</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Maximum number of requests on a connection before it is considered expired
and automatically closed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


338
339
340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_requests'>max_requests</span>
  <span class='ivar'>@max_requests</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A name for this connection.  Allows you to keep your connections apart from
everybody else&#39;s.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


355
356
357</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 355</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="no_proxy-instance_method">
  
    #<strong>no_proxy</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>List of host suffixes which will not be proxied</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


383
384
385</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 383</span>

<span class='kw'>def</span> <span class='id identifier rubyid_no_proxy'>no_proxy</span>
  <span class='ivar'>@no_proxy</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="open_timeout=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="open_timeout-instance_method">
  
    #<strong>open_timeout</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Seconds to wait until a connection is opened.  See Net::HTTP#open_timeout</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


360
361
362</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 360</span>

<span class='kw'>def</span> <span class='id identifier rubyid_open_timeout'>open_timeout</span>
  <span class='ivar'>@open_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="override_headers-instance_method">
  
    #<strong>override_headers</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Headers that are added to every request using Net::HTTP#[]=</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


365
366
367</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 365</span>

<span class='kw'>def</span> <span class='id identifier rubyid_override_headers'>override_headers</span>
  <span class='ivar'>@override_headers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="private_key=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="private_key-instance_method">
  
    #<strong>private_key</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='key-instance_method'>key</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This client&#39;s SSL private key</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 370</span>

<span class='kw'>def</span> <span class='id identifier rubyid_private_key'>private_key</span>
  <span class='ivar'>@private_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="proxy_uri-instance_method">
  
    #<strong>proxy_uri</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The URL through which requests will be proxied</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


378
379
380</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 378</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_uri'>proxy_uri</span>
  <span class='ivar'>@proxy_uri</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="read_timeout=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="read_timeout-instance_method">
  
    #<strong>read_timeout</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Seconds to wait until reading one block.  See Net::HTTP#read_timeout</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


388
389
390</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 388</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_timeout'>read_timeout</span>
  <span class='ivar'>@read_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="request_key-instance_method">
  
    #<strong>request_key</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Where this instance&#39;s request counts live in the thread local variables</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


393
394
395</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 393</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request_key'>request_key</span>
  <span class='ivar'>@request_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="retry_change_requests=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="retry_change_requests-instance_method">
  
    #<strong>retry_change_requests</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Enable retries of non-idempotent requests that change data (e.g. POST
requests) when the server has disconnected.</p>

<p>This will in the worst case lead to multiple requests with the same data,
but it may be useful for some applications.  Take care when enabling this
option to ensure it is safe to POST or perform other non-idempotent
requests to the server.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


463
464
465</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 463</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retry_change_requests'>retry_change_requests</span>
  <span class='ivar'>@retry_change_requests</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="reuse_ssl_sessions=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="reuse_ssl_sessions-instance_method">
  
    #<strong>reuse_ssl_sessions</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>By default SSL sessions are reused to avoid extra SSL handshakes.  Set this
to false if you have problems communicating with an HTTPS server like:</p>

<pre class="code ruby"><code class="ruby">SSL_connect [...] read finished A: unexpected message (OpenSSL::SSL::SSLError)</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 402</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reuse_ssl_sessions'>reuse_ssl_sessions</span>
  <span class='ivar'>@reuse_ssl_sessions</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="socket_options-instance_method">
  
    #<strong>socket_options</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>An array of options for Socket#setsockopt.</p>

<p>By default the TCP_NODELAY option is set on sockets.</p>

<p>To set additional options append them to this array:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_socket_options'>socket_options</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'>Socket</span><span class='op'>::</span><span class='const'>SOL_SOCKET</span><span class='comma'>,</span> <span class='const'>Socket</span><span class='op'>::</span><span class='const'>SO_KEEPALIVE</span><span class='comma'>,</span> <span class='int'>1</span><span class='rbracket'>]</span>
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


413
414
415</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 413</span>

<span class='kw'>def</span> <span class='id identifier rubyid_socket_options'>socket_options</span>
  <span class='ivar'>@socket_options</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="ssl_generation-instance_method">
  
    #<strong>ssl_generation</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Current SSL connection generation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


418
419
420</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 418</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_generation'>ssl_generation</span>
  <span class='ivar'>@ssl_generation</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="ssl_generation_key-instance_method">
  
    #<strong>ssl_generation_key</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Where this instance&#39;s SSL connections live in the thread local
variables</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


423
424
425</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 423</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_generation_key'>ssl_generation_key</span>
  <span class='ivar'>@ssl_generation_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="ssl_version=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="ssl_version-instance_method">
  
    #<strong>ssl_version</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>SSL version to use.</p>

<p>By default, the version will be negotiated automatically between client and
server.  Ruby 1.9 and newer only.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


431
432
433</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 431</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_version'>ssl_version</span>
  <span class='ivar'>@ssl_version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="timeout_key-instance_method">
  
    #<strong>timeout_key</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Where this instance&#39;s last-use times live in the thread local variables</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 436</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timeout_key'>timeout_key</span>
  <span class='ivar'>@timeout_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="verify_callback=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="verify_callback-instance_method">
  
    #<strong>verify_callback</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>SSL verification callback.  Used when ca_file is set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


441
442
443</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 441</span>

<span class='kw'>def</span> <span class='id identifier rubyid_verify_callback'>verify_callback</span>
  <span class='ivar'>@verify_callback</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="verify_mode=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="verify_mode-instance_method">
  
    #<strong>verify_mode</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>HTTPS verify mode.  Defaults to OpenSSL::SSL::VERIFY_PEER which verifies
the server certificate.</p>

<p>If no ca_file or cert_store is set the default system certificate store is
used.</p>

<p>You can use <code>verify_mode</code> to override any default values.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


452
453
454</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 452</span>

<span class='kw'>def</span> <span class='id identifier rubyid_verify_mode'>verify_mode</span>
  <span class='ivar'>@verify_mode</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="detect_idle_timeout-class_method">
  
    .<strong>detect_idle_timeout</strong>(uri, max = 10)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Use this method to detect the idle timeout of the host at <code>uri</code>.
The value returned can be used to configure #idle_timeout. 
<code>max</code> controls the maximum idle timeout to detect.</p>

<p>After</p>

<p>Idle timeout detection is performed by creating a connection then
performing a HEAD request in a loop until the connection terminates waiting
one additional second per loop.</p>

<p>NOTE:  This may not work on ruby &gt; 1.9.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 243</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_detect_idle_timeout'>detect_idle_timeout</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_max'>max</span> <span class='op'>=</span> <span class='int'>10</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='id identifier rubyid_uri'>uri</span> <span class='kw'>unless</span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>Generic</span> <span class='op'>===</span> <span class='id identifier rubyid_uri'>uri</span>
  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Head</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span>

  <span class='id identifier rubyid_http'>http</span> <span class='op'>=</span> <span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net-http-persistent detect_idle_timeout</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_connection_for'>connection_for</span> <span class='id identifier rubyid_uri'>uri</span>

  <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_req'>req</span>

    <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HEAD </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='gvar'>$DEBUG</span>

    <span class='kw'>unless</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTPOK</span> <span class='op'>===</span> <span class='id identifier rubyid_response'>response</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bad response code </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_code'>code</span><span class='embexpr_end'>}</span><span class='tstring_content'> detecting idle timeout</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max'>max</span>

    <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='op'>+=</span> <span class='int'>1</span>

    <span class='gvar'>$stderr</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sleeping </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sleep_time'>sleep_time</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='gvar'>$DEBUG</span>
    <span class='id identifier rubyid_sleep'>sleep</span> <span class='id identifier rubyid_sleep_time'>sleep_time</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span>
  <span class='comment'># ignore StandardErrors, we&#39;ve probably found the idle timeout.
</span><span class='kw'>ensure</span>
  <span class='id identifier rubyid_http'>http</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_sleep_time'>sleep_time</span> <span class='kw'>unless</span> <span class='gvar'>$!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="can_retry?-instance_method">
  
    #<strong>can_retry?</strong>(req, retried_on_ruby_2 = false)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Is the request <code>req</code> idempotent or is retry_change_requests
allowed.</p>

<p>If <code>retried_on_ruby_2</code> is true, true will be returned if we are
on ruby, retry_change_requests is allowed and the request is not
idempotent.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


759
760
761
762
763</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 759</span>

<span class='kw'>def</span> <span class='id identifier rubyid_can_retry?'>can_retry?</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_retried_on_ruby_2'>retried_on_ruby_2</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>return</span> <span class='ivar'>@retry_change_requests</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_idempotent?'>idempotent?</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_retried_on_ruby_2'>retried_on_ruby_2</span>

  <span class='ivar'>@retry_change_requests</span> <span class='op'>||</span> <span class='id identifier rubyid_idempotent?'>idempotent?</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cleanup-instance_method">
  
    #<strong>cleanup</strong>(generation, thread = Thread.current, generation_key = @generation_key)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finishes all connections on the given <code>thread</code> that were created
before the given <code>generation</code> in the threads
<code>generation_key</code> list.</p>

<p>See #shutdown for a bunch of scary warning about misusing this method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 568</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup'>cleanup</span><span class='lparen'>(</span><span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span> <span class='id identifier rubyid_thread'>thread</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='comma'>,</span>
            <span class='id identifier rubyid_generation_key'>generation_key</span> <span class='op'>=</span> <span class='ivar'>@generation_key</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_timeouts'>timeouts</span> <span class='op'>=</span> <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span>

  <span class='lparen'>(</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_generation'>generation</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_old_generation'>old_generation</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='id identifier rubyid_generation_key'>generation_key</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_conns'>conns</span> <span class='op'>=</span> <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='id identifier rubyid_generation_key'>generation_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_old_generation'>old_generation</span>

    <span class='id identifier rubyid_conns'>conns</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_conn'>conn</span><span class='op'>|</span>
      <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_conn'>conn</span><span class='comma'>,</span> <span class='id identifier rubyid_thread'>thread</span>

      <span class='id identifier rubyid_timeouts'>timeouts</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_conn'>conn</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span> <span class='kw'>if</span> <span class='id identifier rubyid_timeouts'>timeouts</span>
    <span class='kw'>end</span> <span class='kw'>if</span> <span class='id identifier rubyid_conns'>conns</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connection_close?-instance_method">
  
    #<strong>connection_close?</strong>(header)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Workaround for missing Net::HTTPRequest#connection_close? on Ruby 1.8</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


769
770
771</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 769</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_close?'>connection_close?</span> <span class='id identifier rubyid_header'>header</span>
  <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_connection_close?'>connection_close?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connection_for-instance_method">
  
    #<strong>connection_for</strong>(uri)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a new connection for <code>uri</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 588</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_for'>connection_for</span> <span class='id identifier rubyid_uri'>uri</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@generation_key</span><span class='rbracket'>]</span>     <span class='op'>||=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@ssl_generation_key</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span>        <span class='op'>||=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='int'>0</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span>        <span class='op'>||=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='const'>EPOCH</span>

  <span class='id identifier rubyid_use_ssl'>use_ssl</span> <span class='op'>=</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_scheme'>scheme</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_use_ssl'>use_ssl</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OpenSSL is not available</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span>
      <span class='const'>HAVE_OPENSSL</span>

    <span class='id identifier rubyid_ssl_generation'>ssl_generation</span> <span class='op'>=</span> <span class='ivar'>@ssl_generation</span>

    <span class='id identifier rubyid_ssl_cleanup'>ssl_cleanup</span> <span class='id identifier rubyid_ssl_generation'>ssl_generation</span>

    <span class='id identifier rubyid_connections'>connections</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@ssl_generation_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_ssl_generation'>ssl_generation</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_generation'>generation</span> <span class='op'>=</span> <span class='ivar'>@generation</span>

    <span class='id identifier rubyid_cleanup'>cleanup</span> <span class='id identifier rubyid_generation'>generation</span>

    <span class='id identifier rubyid_connections'>connections</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@generation_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_generation'>generation</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_net_http_args'>net_http_args</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_connection_id'>connection_id</span> <span class='op'>=</span> <span class='id identifier rubyid_net_http_args'>net_http_args</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='ivar'>@proxy_uri</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_proxy_bypass?'>proxy_bypass?</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_connection_id'>connection_id</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@proxy_connection_id</span>
    <span class='id identifier rubyid_net_http_args'>net_http_args</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='ivar'>@proxy_args</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_connections'>connections</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_connections'>connections</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_connections'>connections</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_http_class'>http_class</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_net_http_args'>net_http_args</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_connections'>connections</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ssl'>ssl</span> <span class='id identifier rubyid_connection'>connection</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_ssl'>use_ssl</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_reset'>reset</span> <span class='id identifier rubyid_connection'>connection</span> <span class='kw'>if</span> <span class='id identifier rubyid_expired?'>expired?</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_connection'>connection</span> <span class='kw'>unless</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_started?'>started?</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_read_timeout'>read_timeout</span> <span class='op'>=</span> <span class='ivar'>@read_timeout</span> <span class='kw'>if</span> <span class='ivar'>@read_timeout</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_keep_alive_timeout'>keep_alive_timeout</span> <span class='op'>=</span> <span class='ivar'>@idle_timeout</span> <span class='kw'>if</span> <span class='ivar'>@idle_timeout</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:keep_alive_timeout=</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_connection'>connection</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNREFUSED</span>
  <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_proxy_address'>proxy_address</span> <span class='op'>||</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span>
  <span class='id identifier rubyid_port'>port</span>    <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_proxy_port'>proxy_port</span>    <span class='op'>||</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>connection refused: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EHOSTDOWN</span>
  <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_proxy_address'>proxy_address</span> <span class='op'>||</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span>
  <span class='id identifier rubyid_port'>port</span>    <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_proxy_port'>proxy_port</span>    <span class='op'>||</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>host down: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="connection_keep_alive?-instance_method">
  
    #<strong>connection_keep_alive?</strong>(header)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Workaround for missing Net::HTTPRequest#connection_keep_alive? on Ruby 1.8</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


776
777
778</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 776</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection_keep_alive?'>connection_keep_alive?</span> <span class='id identifier rubyid_header'>header</span>
  <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_connection_keep_alive?'>connection_keep_alive?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="error_message-instance_method">
  
    #<strong>error_message</strong>(connection)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an error message containing the number of requests performed on
this connection</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


653
654
655
656
657
658
659
660
661</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 653</span>

<span class='kw'>def</span> <span class='id identifier rubyid_error_message'>error_message</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='id identifier rubyid_requests'>requests</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='rbracket'>]</span> <span class='op'>-</span> <span class='int'>1</span> <span class='comment'># fixup
</span>  <span class='id identifier rubyid_last_use'>last_use</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_age'>age</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_last_use'>last_use</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>after </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requests'>requests</span><span class='embexpr_end'>}</span><span class='tstring_content'> requests on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span> \
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>last used </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_age'>age</span><span class='embexpr_end'>}</span><span class='tstring_content'> seconds ago</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="escape-instance_method">
  
    #<strong>escape</strong>(str)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>URI::escape wrapper</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


666
667
668</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 666</span>

<span class='kw'>def</span> <span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_str'>str</span>
  <span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_escape'>escape</span> <span class='id identifier rubyid_str'>str</span> <span class='kw'>if</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expired?-instance_method">
  
    #<strong>expired?</strong>(connection)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true if the connection should be reset due to an idle timeout, or
maximum request count, false otherwise.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


682
683
684
685
686
687
688
689
690
691</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 682</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expired?'>expired?</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='id identifier rubyid_requests'>requests</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='kw'>true</span>  <span class='kw'>if</span>     <span class='ivar'>@max_requests</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_requests'>requests</span> <span class='op'>&gt;=</span> <span class='ivar'>@max_requests</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@idle_timeout</span>
  <span class='kw'>return</span> <span class='kw'>true</span>  <span class='kw'>if</span>     <span class='ivar'>@idle_timeout</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>

  <span class='id identifier rubyid_last_used'>last_used</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='rbracket'>]</span>

  <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_last_used'>last_used</span> <span class='op'>&gt;</span> <span class='ivar'>@idle_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="finish-instance_method">
  
    #<strong>finish</strong>(connection, thread = Thread.current)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finishes the Net::HTTP <code>connection</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


714
715
716
717
718
719
720
721</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 714</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_connection'>connection</span><span class='comma'>,</span> <span class='id identifier rubyid_thread'>thread</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_requests'>requests</span> <span class='op'>=</span> <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_requests'>requests</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_finish'>finish</span>
<span class='kw'>rescue</span> <span class='const'>IOError</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="http_class-instance_method">
  
    #<strong>http_class</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>:nodoc:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


723
724
725
726
727
728
729
730
731
732
733</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 723</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http_class'>http_class</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>if</span> <span class='const'>RUBY_VERSION</span> <span class='op'>&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>2.0</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>then</span>
    <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span>
  <span class='kw'>elsif</span> <span class='lbracket'>[</span><span class='symbol'>:Artifice</span><span class='comma'>,</span> <span class='symbol'>:FakeWeb</span><span class='comma'>,</span> <span class='symbol'>:WebMock</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_klass'>klass</span><span class='op'>|</span>
           <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_klass'>klass</span><span class='rparen'>)</span>
        <span class='rbrace'>}</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='ivar'>@reuse_ssl_sessions</span> <span class='kw'>then</span>
      <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span>
  <span class='kw'>else</span>
    <span class='const'>Bundler</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Persistent</span><span class='op'>::</span><span class='const'>SSLReuse</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="http_version-instance_method">
  
    #<strong>http_version</strong>(uri)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the HTTP protocol version for <code>uri</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


738
739
740</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 738</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http_version'>http_version</span> <span class='id identifier rubyid_uri'>uri</span>
  <span class='ivar'>@http_versions</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="idempotent?-instance_method">
  
    #<strong>idempotent?</strong>(req)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Is <code>req</code> idempotent according to RFC 2616?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


745
746
747
748
749
750
751</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 745</span>

<span class='kw'>def</span> <span class='id identifier rubyid_idempotent?'>idempotent?</span> <span class='id identifier rubyid_req'>req</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_req'>req</span>
  <span class='kw'>when</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Delete</span><span class='comma'>,</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Get</span><span class='comma'>,</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Head</span><span class='comma'>,</span>
       <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Options</span><span class='comma'>,</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Put</span><span class='comma'>,</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Trace</span> <span class='kw'>then</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="max_age-instance_method">
  
    #<strong>max_age</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Deprecated in favor of #expired?</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


800
801
802
803
804</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 800</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_age'>max_age</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>return</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>1</span> <span class='kw'>unless</span> <span class='ivar'>@idle_timeout</span>

  <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='ivar'>@idle_timeout</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="normalize_uri-instance_method">
  
    #<strong>normalize_uri</strong>(uri)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds “http://” to the String <code>uri</code> if it is missing.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


809
810
811</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 809</span>

<span class='kw'>def</span> <span class='id identifier rubyid_normalize_uri'>normalize_uri</span> <span class='id identifier rubyid_uri'>uri</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?:</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_uri'>uri</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pipeline-instance_method">
  
    #<strong>pipeline</strong>(uri, requests, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Pipelines <code>requests</code> to the HTTP server at <code>uri</code>
yielding responses if a block is given.  Returns all responses recieved.</p>

<p>See <a
href="http://docs.seattlerb.org/net-http-pipeline/Net/HTTP/Pipeline.html">Net::HTTP::Pipeline</a>
for further details.</p>

<p>Only if <code>net-http-pipeline</code> was required before
<code>net-http-persistent</code> #pipeline will be present.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


824
825
826
827
828</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 824</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pipeline'>pipeline</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='comment'># :yields: responses
</span>  <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_connection_for'>connection_for</span> <span class='id identifier rubyid_uri'>uri</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_pipeline'>pipeline</span> <span class='id identifier rubyid_requests'>requests</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="proxy=-instance_method">
  
    #<strong>proxy=</strong>(proxy)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the proxy server.  The <code>proxy</code> may be the URI of the proxy
server, the symbol <code>:ENV</code> which will read the proxy from the
environment or nil to disable use of a proxy.  See #proxy_from_env for
details on setting the proxy from the environment.</p>

<p>If the proxy URI is set after requests have been made, the next request
will shut-down and re-open all connections.</p>

<p>The <code>no_proxy</code> query parameter can be used to specify hosts
which shouldn&#39;t be reached via proxy; if set it should be a comma
separated list of hostname suffixes, optionally with <code>:port</code>
appended, for example <code>example.com,some.host:8080</code>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 856</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy='>proxy=</span> <span class='id identifier rubyid_proxy'>proxy</span>
  <span class='ivar'>@proxy_uri</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_proxy'>proxy</span>
               <span class='kw'>when</span> <span class='symbol'>:ENV</span>      <span class='kw'>then</span> <span class='id identifier rubyid_proxy_from_env'>proxy_from_env</span>
               <span class='kw'>when</span> <span class='const'>URI</span><span class='op'>::</span><span class='const'>HTTP</span> <span class='kw'>then</span> <span class='id identifier rubyid_proxy'>proxy</span>
               <span class='kw'>when</span> <span class='kw'>nil</span>       <span class='kw'>then</span> <span class='comment'># ignore
</span>               <span class='kw'>else</span> <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>proxy must be :ENV or a URI::HTTP</span><span class='tstring_end'>&#39;</span></span>
               <span class='kw'>end</span>

  <span class='ivar'>@no_proxy</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>

  <span class='kw'>if</span> <span class='ivar'>@proxy_uri</span> <span class='kw'>then</span>
    <span class='ivar'>@proxy_args</span> <span class='op'>=</span> <span class='lbracket'>[</span>
      <span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span>
      <span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='comma'>,</span>
      <span class='id identifier rubyid_unescape'>unescape</span><span class='lparen'>(</span><span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='id identifier rubyid_unescape'>unescape</span><span class='lparen'>(</span><span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='rbracket'>]</span>

    <span class='ivar'>@proxy_connection_id</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>*</span><span class='ivar'>@proxy_args</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>

    <span class='kw'>if</span> <span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_query'>query</span> <span class='kw'>then</span>
      <span class='ivar'>@no_proxy</span> <span class='op'>=</span> <span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='ivar'>@proxy_uri</span><span class='period'>.</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no_proxy</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_reconnect'>reconnect</span>
  <span class='id identifier rubyid_reconnect_ssl'>reconnect_ssl</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="proxy_bypass?-instance_method">
  
    #<strong>proxy_bypass?</strong>(host, port)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns true when proxy should by bypassed for host.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


930
931
932
933
934
935
936
937
938
939
940</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 930</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_bypass?'>proxy_bypass?</span> <span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span>
  <span class='id identifier rubyid_host'>host</span> <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span>
  <span class='id identifier rubyid_host_port'>host_port</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_port'>port</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>:</span><span class='tstring_end'>&#39;</span></span>

  <span class='ivar'>@no_proxy</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_host'>host</span><span class='lbracket'>[</span><span class='op'>-</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>or</span>
       <span class='id identifier rubyid_host_port'>host_port</span><span class='lbracket'>[</span><span class='op'>-</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>end</span>

  <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="proxy_from_env-instance_method">
  
    #<strong>proxy_from_env</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a URI for an HTTP proxy server from ENV variables.</p>

<p>If <code>HTTP_PROXY</code> is set a proxy will be returned.</p>

<p>If <code>HTTP_PROXY_USER</code> or <code>HTTP_PROXY_PASS</code> are set the
URI is given the indicated user and password unless HTTP_PROXY contains
either of these in the URI.</p>

<p>The <code>NO_PROXY</code> ENV variable can be used to specify hosts which
shouldn&#39;t be reached via proxy; if set it should be a comma separated
list of hostname suffixes, optionally with <code>:port</code> appended, for
example <code>example.com,some.host:8080</code>. When set to <code>*</code>
no proxy will be returned.</p>

<p>For Windows users, lowercase ENV variables are preferred over uppercase ENV
variables.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 903</span>

<span class='kw'>def</span> <span class='id identifier rubyid_proxy_from_env'>proxy_from_env</span>
  <span class='id identifier rubyid_env_proxy'>env_proxy</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http_proxy</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_PROXY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_env_proxy'>env_proxy</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_env_proxy'>env_proxy</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span> <span class='id identifier rubyid_normalize_uri'>normalize_uri</span> <span class='id identifier rubyid_env_proxy'>env_proxy</span>

  <span class='id identifier rubyid_env_no_proxy'>env_no_proxy</span> <span class='op'>=</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no_proxy</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NO_PROXY</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># &#39;*&#39; is special case for always bypass
</span>  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_env_no_proxy'>env_no_proxy</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_env_no_proxy'>env_no_proxy</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no_proxy=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span><span class='id identifier rubyid_env_no_proxy'>env_no_proxy</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span> <span class='kw'>or</span> <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>     <span class='op'>=</span> <span class='id identifier rubyid_escape'>escape</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http_proxy_user</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_PROXY_USER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_escape'>escape</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http_proxy_pass</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_PROXY_PASS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_uri'>uri</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reconnect-instance_method">
  
    #<strong>reconnect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Forces reconnection of HTTP connections.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


945
946
947</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 945</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reconnect'>reconnect</span>
  <span class='ivar'>@generation</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reconnect_ssl-instance_method">
  
    #<strong>reconnect_ssl</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Forces reconnection of SSL connections.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


952
953
954</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 952</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reconnect_ssl'>reconnect_ssl</span>
  <span class='ivar'>@ssl_generation</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="request-instance_method">
  
    #<strong>request</strong>(uri, req = nil, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Makes a request on <code>uri</code>.  If <code>req</code> is nil a
Net::HTTP::Get is performed against <code>uri</code>.</p>

<p>If a block is passed #request behaves like Net::HTTP#request (the body of
the response will not have been read).</p>

<p><code>req</code> must be a Net::HTTPRequest subclass (see Net::HTTP for a
list).</p>

<p>If there is an error and the request is idempotent according to RFC 2616 it
will be retried automatically.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 988</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_retried'>retried</span>      <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_bad_response'>bad_response</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='id identifier rubyid_request_setup'>request_setup</span> <span class='id identifier rubyid_req'>req</span> <span class='op'>||</span> <span class='id identifier rubyid_uri'>uri</span>

  <span class='id identifier rubyid_connection'>connection</span> <span class='op'>=</span> <span class='id identifier rubyid_connection_for'>connection_for</span> <span class='id identifier rubyid_uri'>uri</span>
  <span class='id identifier rubyid_connection_id'>connection_id</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span>

  <span class='kw'>begin</span>
    <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_connection_close?'>connection_close?</span><span class='lparen'>(</span><span class='id identifier rubyid_req'>req</span><span class='rparen'>)</span> <span class='kw'>or</span>
       <span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_http_version'>http_version</span> <span class='op'>&lt;=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1.0</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>and</span>
        <span class='kw'>not</span> <span class='id identifier rubyid_connection_keep_alive?'>connection_keep_alive?</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>or</span>
       <span class='id identifier rubyid_connection_close?'>connection_close?</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span> <span class='kw'>then</span>
      <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_finish'>finish</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTPBadResponse</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_error_message'>error_message</span> <span class='id identifier rubyid_connection'>connection</span>

    <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_connection'>connection</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too many bad responses </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span>
      <span class='id identifier rubyid_bad_response'>bad_response</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_can_retry?'>can_retry?</span> <span class='id identifier rubyid_req'>req</span>

    <span class='id identifier rubyid_bad_response'>bad_response</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>retry</span>
  <span class='kw'>rescue</span> <span class='op'>*</span><span class='const'>RETRIED_EXCEPTIONS</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span> <span class='comment'># retried on ruby 2
</span>    <span class='id identifier rubyid_request_failed'>request_failed</span> <span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_connection'>connection</span> <span class='kw'>if</span>
      <span class='id identifier rubyid_retried'>retried</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_can_retry?'>can_retry?</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='ivar'>@retried_on_ruby_2</span>

    <span class='id identifier rubyid_reset'>reset</span> <span class='id identifier rubyid_connection'>connection</span>

    <span class='id identifier rubyid_retried'>retried</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>retry</span>
  <span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EINVAL</span><span class='comma'>,</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ETIMEDOUT</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span> <span class='comment'># not retried on ruby 2
</span>    <span class='id identifier rubyid_request_failed'>request_failed</span> <span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_connection'>connection</span> <span class='kw'>if</span> <span class='id identifier rubyid_retried'>retried</span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_can_retry?'>can_retry?</span> <span class='id identifier rubyid_req'>req</span>

    <span class='id identifier rubyid_reset'>reset</span> <span class='id identifier rubyid_connection'>connection</span>

    <span class='id identifier rubyid_retried'>retried</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>retry</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_connection'>connection</span>

    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>ensure</span>
    <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_connection_id'>connection_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='kw'>end</span>

  <span class='ivar'>@http_versions</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_http_version'>http_version</span>

  <span class='id identifier rubyid_response'>response</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="request_failed-instance_method">
  
    #<strong>request_failed</strong>(exception, req, connection)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Raises an Error for <code>exception</code> which resulted from attempting
the request <code>req</code> on the <code>connection</code>.</p>

<p>Finishes the <code>connection</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Persistent/Error.html" title="Bundler::Persistent::Net::HTTP::Persistent::Error (class)">Error</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1051
1052
1053
1054
1055
1056
1057
1058
1059</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1051</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request_failed'>request_failed</span> <span class='id identifier rubyid_exception'>exception</span><span class='comma'>,</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_connection'>connection</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_due_to'>due_to</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(due to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_content'> - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>too many connection resets </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_due_to'>due_to</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_error_message'>error_message</span> <span class='id identifier rubyid_connection'>connection</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_connection'>connection</span>


  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>Error</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_exception'>exception</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="request_setup-instance_method">
  
    #<strong>request_setup</strong>(req_or_uri)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a GET request if <code>req_or_uri</code> is a URI and adds headers
to the request.</p>

<p>Returns the request.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1067</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request_setup'>request_setup</span> <span class='id identifier rubyid_req_or_uri'>req_or_uri</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='const'>URI</span> <span class='op'>===</span> <span class='id identifier rubyid_req_or_uri'>req_or_uri</span> <span class='kw'>then</span>
          <span class='const'>Net</span><span class='op'>::</span><span class='const'>HTTP</span><span class='op'>::</span><span class='const'>Get</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_req_or_uri'>req_or_uri</span><span class='period'>.</span><span class='id identifier rubyid_request_uri'>request_uri</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_req_or_uri'>req_or_uri</span>
        <span class='kw'>end</span>

  <span class='ivar'>@headers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_pair'>pair</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@override_headers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_req'>req</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_req'>req</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Connection</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Connection</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keep-alive</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_add_field'>add_field</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Keep-Alive</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@keep_alive</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_req'>req</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset-instance_method">
  
    #<strong>reset</strong>(connection)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finishes then restarts the Net::HTTP <code>connection</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 959</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset'>reset</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span>

  <span class='id identifier rubyid_finish'>finish</span> <span class='id identifier rubyid_connection'>connection</span>

  <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_connection'>connection</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNREFUSED</span>
  <span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='const'>Error</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>connection refused: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_set_backtrace'>set_backtrace</span> <span class='gvar'>$@</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EHOSTDOWN</span>
  <span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='const'>Error</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>host down: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_set_backtrace'>set_backtrace</span> <span class='gvar'>$@</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_e'>e</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shutdown-instance_method">
  
    #<strong>shutdown</strong>(thread = Thread.current)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Shuts down all connections for <code>thread</code>.</p>

<p>Uses the current thread by default.</p>

<p>If you&#39;ve used Bundler::Persistent::Net::HTTP::Persistent across
multiple threads you should call this in each thread when you&#39;re done
making HTTP requests.</p>

<p><strong>NOTE</strong>: Calling shutdown for another thread can be
dangerous!</p>

<p>If the thread is still using the connection it may cause an error!  It is
best to call #shutdown in the thread at the appropriate time instead!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1103
1104
1105
1106
1107
1108
1109
1110
1111
1112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown'>shutdown</span> <span class='id identifier rubyid_thread'>thread</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
  <span class='id identifier rubyid_generation'>generation</span> <span class='op'>=</span> <span class='id identifier rubyid_reconnect'>reconnect</span>
  <span class='id identifier rubyid_cleanup'>cleanup</span> <span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span> <span class='id identifier rubyid_thread'>thread</span><span class='comma'>,</span> <span class='ivar'>@generation_key</span>

  <span class='id identifier rubyid_ssl_generation'>ssl_generation</span> <span class='op'>=</span> <span class='id identifier rubyid_reconnect_ssl'>reconnect_ssl</span>
  <span class='id identifier rubyid_cleanup'>cleanup</span> <span class='id identifier rubyid_ssl_generation'>ssl_generation</span><span class='comma'>,</span> <span class='id identifier rubyid_thread'>thread</span><span class='comma'>,</span> <span class='ivar'>@ssl_generation_key</span>

  <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='ivar'>@request_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_thread'>thread</span><span class='lbracket'>[</span><span class='ivar'>@timeout_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shutdown_in_all_threads-instance_method">
  
    #<strong>shutdown_in_all_threads</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Shuts down all connections in all threads</p>

<p><strong>NOTE</strong>: THIS METHOD IS VERY DANGEROUS!</p>

<p>Do not call this method if other threads are still using their connections!
Call #shutdown at the appropriate time instead!</p>

<p>Use this method only as a last resort!</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1124
1125
1126
1127
1128
1129
1130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown_in_all_threads'>shutdown_in_all_threads</span>
  <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_thread'>thread</span><span class='op'>|</span>
    <span class='id identifier rubyid_shutdown'>shutdown</span> <span class='id identifier rubyid_thread'>thread</span>
  <span class='kw'>end</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ssl-instance_method">
  
    #<strong>ssl</strong>(connection)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Enables SSL on <code>connection</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl'>ssl</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_use_ssl'>use_ssl</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_ssl_version'>ssl_version</span> <span class='op'>=</span> <span class='ivar'>@ssl_version</span> <span class='kw'>if</span> <span class='ivar'>@ssl_version</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>=</span> <span class='ivar'>@verify_mode</span>

  <span class='kw'>if</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_PEER</span> <span class='op'>==</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_NONE</span> <span class='kw'>and</span>
     <span class='kw'>not</span> <span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_const_defined?'>const_defined?</span><span class='lparen'>(</span><span class='symbol'>:I_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG</span><span class='rparen'>)</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_warn'>warn</span> <span class='heredoc_beg'>&lt;&lt;-WARNING</span>
<span class='tstring_content'>                           !!!SECURITY WARNING!!!

The SSL HTTP connection to:

</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_address'>address</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span><span class='embexpr_end'>}</span><span class='tstring_content'>

                         !!!MAY NOT BE VERIFIED!!!

On your platform your OpenSSL implementation is broken.

There is no difference between the values of VERIFY_NONE and VERIFY_PEER.

This means that attempting to verify the security of SSL connections may not
work.  This exposes you to man-in-the-middle exploits, snooping on the
contents of your connection and other dangers to the security of your data.

To disable this warning define the following constant at top-level in your
application:

I_KNOW_THAT_OPENSSL_VERIFY_PEER_EQUALS_VERIFY_NONE_IS_WRONG = nil

</span><span class='heredoc_end'>    WARNING
</span>  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@ca_file</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_ca_file'>ca_file</span> <span class='op'>=</span> <span class='ivar'>@ca_file</span>
    <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_verify_mode'>verify_mode</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_PEER</span>
    <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_verify_callback'>verify_callback</span> <span class='op'>=</span> <span class='ivar'>@verify_callback</span> <span class='kw'>if</span> <span class='ivar'>@verify_callback</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@certificate</span> <span class='kw'>and</span> <span class='ivar'>@private_key</span> <span class='kw'>then</span>
    <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='ivar'>@certificate</span>
    <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span>  <span class='op'>=</span> <span class='ivar'>@private_key</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_cert_store'>cert_store</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@cert_store</span> <span class='kw'>then</span>
                            <span class='ivar'>@cert_store</span>
                          <span class='kw'>else</span>
                            <span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Store</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
                            <span class='id identifier rubyid_store'>store</span><span class='period'>.</span><span class='id identifier rubyid_set_default_paths'>set_default_paths</span>
                            <span class='id identifier rubyid_store'>store</span>
                          <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ssl_cleanup-instance_method">
  
    #<strong>ssl_cleanup</strong>(generation)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finishes all connections that existed before the given SSL parameter
<code>generation</code>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1193
1194
1195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 1193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ssl_cleanup'>ssl_cleanup</span> <span class='id identifier rubyid_generation'>generation</span> <span class='comment'># :nodoc:
</span>  <span class='id identifier rubyid_cleanup'>cleanup</span> <span class='id identifier rubyid_generation'>generation</span><span class='comma'>,</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='comma'>,</span> <span class='ivar'>@ssl_generation_key</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>(connection)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Starts the Net::HTTP <code>connection</code></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


696
697
698
699
700
701
702
703
704
705
706
707
708
709</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 696</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_set_debug_output'>set_debug_output</span> <span class='ivar'>@debug_output</span> <span class='kw'>if</span> <span class='ivar'>@debug_output</span>
  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_open_timeout'>open_timeout</span> <span class='op'>=</span> <span class='ivar'>@open_timeout</span> <span class='kw'>if</span> <span class='ivar'>@open_timeout</span>

  <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>

  <span class='id identifier rubyid_socket'>socket</span> <span class='op'>=</span> <span class='id identifier rubyid_connection'>connection</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span> <span class='symbol'>:@socket</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_socket'>socket</span> <span class='kw'>then</span> <span class='comment'># for fakeweb
</span>    <span class='ivar'>@socket_options</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_option'>option</span><span class='op'>|</span>
      <span class='id identifier rubyid_socket'>socket</span><span class='period'>.</span><span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_setsockopt'>setsockopt</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_option'>option</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unescape-instance_method">
  
    #<strong>unescape</strong>(str)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>URI::unescape wrapper</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


673
674
675</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/bundler/vendor/net-http-persistent/lib/net/http/persistent.rb', line 673</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unescape'>unescape</span> <span class='id identifier rubyid_str'>str</span>
  <span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_unescape'>unescape</span> <span class='id identifier rubyid_str'>str</span> <span class='kw'>if</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Mar 18 19:39:48 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>